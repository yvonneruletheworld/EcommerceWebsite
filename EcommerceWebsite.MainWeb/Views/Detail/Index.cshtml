@using EcommerceWebsite.Utilities.ViewModel
@using EcommerceWebsite.Data.Enum
@model DetailVM
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Chi Tiết";
}

@{
    //var pre = (Dictionary<string, string>)ViewData["PreviousPage"];
    var sanPham = Model.SanPham;
    var bangDinhLuong = Model.SanPham.BangGia.Where(dl => dl.MaThuocTinh == nameof(ProductPorpertyCode.TT07)).ToList();
    //var demision = Model.SanPham.
}


<script>
    var model = @Json.Serialize(Model);

</script>
<!-- Begin Li's Breadcrumb Area -->
<div class="breadcrumb-area">
    <div class="container">
        <div class="breadcrumb-content">
            <ul>
                <li><a href="@Url.Action("Index", "Home")">Trang Chủ</a></li>
                <li class="active">@sanPham.TenSanPham</li>
            </ul>
        </div>
    </div>
</div>
<!-- Li's Breadcrumb Area End Here -->
<!-- content-wraper start -->
<div class="content-wraper">
    <div class="container">
        <div class="row single-product-area">
            <div class="col-lg-5 col-md-6">
                <!-- Product Details Left -->
                <div class="product-details-left">
                    <div class="product-details-images slider-navigation-1">

                        @foreach (var img in sanPham.ListHinhAnh)
                        {
                            <div class="lg-image">
                                <a class="popup-img venobox vbox-item" href="@img.GiaTri" data-gall="myGallery">
                                    <img src="@img.GiaTri" alt="@img.DonVi">
                                </a>
                            </div>
                        }
                    </div>
                    <div class="product-details-thumbs slider-thumbs-1">
                        @foreach (var img in sanPham.ListHinhAnh)
                        {
                            <div class="sm-image"><img src="@img.GiaTri" alt="@img.DonVi"></div>
                        }
                    </div>
                </div>
                <!--// Product Details Left -->
            </div>

            <div class="col-lg-7 col-md-6">
                <div class="product-details-view-content pt-60">
                    <div class="product-info">
                        <h2>@sanPham.TenSanPham</h2>
                        <span class="product-details-ref">Nhãn hàng: @sanPham.NhanHieu</span>
                        <div class="rating-box pt-20">
                            <ul class="rating rating-with-review-item">
                                <li><i class="fa fa-star-o"></i></li>
                                <li><i class="fa fa-star-o"></i></li>
                                <li><i class="fa fa-star-o"></i></li>
                                <li class="no-star"><i class="fa fa-star-o"></i></li>
                                <li class="no-star"><i class="fa fa-star-o"></i></li>
                                <li class="review-item"><a href="#">Đọc Đánh giá</a></li>
                                <li class="review-item"><a href="#">Viết Đánh giá</a></li>
                            </ul>
                        </div>
                        <div class="price-box pt-20">
                            <span class="new-price new-price-2 product-pride-id"></span>
                        </div>
                        <div class="product-desc">
                            <p>
                                <span class="product-desciption-shortcut">

                                </span>
                                <a style="text-decoration: none; color: yellow" href="#product-desciption">Xem thêm</a>
                            </p>
                        </div>
                        <div class="product-variants">
                            <div class="produt-variants-size">
                                <label for="">Dung lượng</label>
                                @Html.DropDownListFor(sp => sp.SanPham.BangGia , new SelectList(bangDinhLuong, "MaDinhLuong", "TenDinhLuong"), new {
                               @class = "nice-select",
                               @onchange = "dinhLuongChanged(this)",
                               placeholder = "Dung lượng"
                           })
                                @*<select class="nice-select">
                                    <option value="1" title="S" selected="selected">40x60cm</option>
                                    <option value="2" title="M">60x90cm</option>
                                    <option value="3" title="L">80x120cm</option>
                                </select>*@
                            </div>
                        </div>
                        <div class="single-add-to-cart">
                            <form action="#" class="cart-quantity">
                                <div class="quantity">
                                    <label>Số lượng</label>
                                    <div class="cart-plus-minus">
                                        <input class="cart-plus-minus-box" value="1" type="text">
                                        <div class="dec qtybutton"><i class="fa fa-angle-down"></i></div>
                                        <div class="inc qtybutton"><i class="fa fa-angle-up"></i></div>
                                    </div>
                                </div>
                                <button class="add-to-cart" type="submit">Thêm vào giỏ hàng</button>
                            </form>
                        </div>
                        <div class="product-additional-info pt-25">
                            <a class="wishlist-btn" href="wishlist.html"><i class="fa fa-heart-o"></i>Add to wishlist</a>
                            <div class="product-social-sharing pt-25">
                                <ul>
                                    <li class="facebook"><a href="#"><i class="fa fa-facebook"></i>Facebook</a></li>
                                    <li class="twitter"><a href="#"><i class="fa fa-twitter"></i>Twitter</a></li>
                                    <li class="google-plus"><a href="#"><i class="fa fa-google-plus"></i>Google +</a></li>
                                    <li class="instagram"><a href="#"><i class="fa fa-instagram"></i>Instagram</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="block-reassurance">
                            <ul>
                                <li>
                                    <div class="reassurance-item">
                                        <div class="reassurance-icon">
                                            <i class="fa fa-check-square-o"></i>
                                        </div>
                                        <p> Đảm bảo chất lượng hàng hóa</p>
                                    </div>
                                </li>
                                <li>
                                    <div class="reassurance-item">
                                        <div class="reassurance-icon">
                                            <i class="fa fa-truck"></i>
                                        </div>
                                        <p> Giao hàng nhanh chóng và an toàn</p>
                                    </div>
                                </li>
                                <li>
                                    <div class="reassurance-item">
                                        <div class="reassurance-icon">
                                            <i class="fa fa-exchange"></i>
                                        </div>
                                        <p> Hỗ trợ đổi trả hàng hóa </p>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- content-wraper end -->

<script>
    $(function () {
        var dft_price = model.sanPham.bangGia[0].giaBan;
        $('.product-pride-id').text(dft_price + ' VNĐ');
    });

    function dinhLuongChanged(e) {
        var valueDemission = e.value;
        var prd_pride = model.sanPham.bangGia.find(x => x.maDinhLuong === valueDemission);
        console.log(prd_pride);
        $('.product-pride-id').text(prd_pride.giaBan + ' VNĐ');
    };
</script>